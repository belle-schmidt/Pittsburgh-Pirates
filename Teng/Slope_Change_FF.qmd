---
title: "Slope_change - FF"
format: html
editor: visual
---

## Slope_Change_FF

## Load Data
```{r}
Joined_FanGraphs_Statcast <- read.csv("D:/R files/CMU/Pirates/Joined_FanGraphs_Statcast.csv")
FF_Over_100 <- Joined_FanGraphs_Statcast |>
  filter(times_thrown_FF >99)
```

## Velocity
```{r}
# RV with Year and Velocity
RV_Velocity <- lm(run_value_per100_FF ~ factor(Season) + avg_velocity_FF, data = FF_Over_100)
RV_Velocity <- lm(run_value_per100_FF ~ factor(Season) * avg_velocity_FF, data = FF_Over_100)
RV_Velocity <- lm(run_value_per100_FF ~ factor(Season) : avg_velocity_FF, data = FF_Over_100)
summary(RV_Velocity)
tidy_RV_Velocity <- tidy(RV_Velocity)
```
```{r}
tidy_RV_Velocity <- tidy_RV_Velocity %>% filter(term != "(Intercept)")
ggplot(tidy_RV_Velocity , aes(x = term, y = estimate)) +
  geom_line(group = 1) +
  geom_point() +
  labs(title = "Estimates from Run Value Linear Model",
       x = "Term",
       y = "Estimate") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```


```{r}
ggplot(FF_Over_100, aes(x = avg_velocity_FF, y = run_value_per100_FF * 100, color = factor(Season))) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE, aes(group = factor(Season))) +
  labs(title = "Run Value vs Velocity Linear Model",
       x = "Average Velocity (FF)",
       y = "Run Value per 100 (FF)",
       color = "Season") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```


```{r}
#Stuff+ with Year and Velocity
Stuff_Plus_Velocity <- lm(stuff_plus_stuff_FF ~ factor(Season) + avg_velocity_FF, data = FF_Over_100)
Stuff_Plus_Velocity <- lm(stuff_plus_stuff_FF ~ factor(Season)*avg_velocity_FF, data = FF_Over_100)
Stuff_Plus_Velocity <- lm(stuff_plus_stuff_FF ~ factor(Season):avg_velocity_FF -1, data = FF_Over_100)
summary(Stuff_Plus_Velocity)
tidy_Stuff_Plus_Velocity <- tidy(Stuff_Plus_Velocity)
```
```{r}
tidy_Stuff_Plus_Velocity <- tidy_Stuff_Plus_Velocity %>% filter(term != "(Intercept)")
ggplot(tidy_Stuff_Plus_Velocity , aes(x = term, y = estimate)) +
  geom_line(group = 1) +
  geom_point() +
  labs(title = "Estimates from Stuff+ Linear Model",
       x = "Term",
       y = "Estimate") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```



## Extension
```{r}
# RV with year and Extension
RV_Extension <- lm(scale(run_value_per100_FF) ~ factor(Season) : avg_release_extension_FF, data = FF_Over_100)
summary(RV_Extension)
tidy_RV_Extension <- tidy(RV_Extension)
```
```{r}
tidy_RV_Extension <- tidy_RV_Extension %>% filter(term != "(Intercept)")
ggplot(tidy_RV_Extension , aes(x = term, y = estimate)) +
  geom_line(group = 1) +
  geom_point() +
  labs(title = "Estimates from Run Value Linear Model",
       x = "Term",
       y = "Estimate") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```



```{r}
# Stuff+ with year and Extension
Stuff_Plus_Extension <- lm(scale(stuff_plus_stuff_FF) ~ factor(Season) : avg_release_extension_FF , data = FF_Over_100)
summary(Stuff_Plus_Extension)
tidy_Stuff_Plus_Extension <- tidy(Stuff_Plus_Extension)
```
```{r}
tidy_Stuff_Plus_Extension <- tidy_Stuff_Plus_Extension %>% filter(term != "(Intercept)")
# Plotting the line chart using estimates
ggplot(tidy_Stuff_Plus_Extension, aes(x = term, y = estimate)) +
  geom_line(group = 1) +
  geom_point() +
  labs(title = "Estimates from Stuff Plus Extension Linear Model",
       x = "Term",
       y = "Estimate") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```



##Load Data
```{r}
mlb_pitching_stats <- read.csv("D:/R files/CMU/Pirates/mlb_pitching_stats_2020-24.csv")
```

